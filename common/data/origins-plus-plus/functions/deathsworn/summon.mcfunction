execute if entity @s[nbt={SelectedItem:{tag:{mob:"Cave_Spider"}}}] run summon minecraft:cave_spider ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Creeper"}}}] run summon minecraft:creeper ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Drowned"}}}] run summon minecraft:drowned ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Evoker"}}}] run summon minecraft:evoker ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Ghast"}}}] run summon minecraft:ghast ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Husk"}}}] run summon minecraft:husk ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Magma_Cube"}}}] run summon minecraft:magma_cube ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Piglin_Brute"}}}] run summon minecraft:piglin_brute ^ ^ ^ {HandItems:[{id:"minecraft:golden_axe",Count:1b,tag:{AttributeModifiers:[{AttributeName:"generic.attack_damage",Name:"generic.attack_damage",Amount:1,Operation:0,UUID:[I;-55720091,611075810,-1271712052,-552013438]}]}},{}],Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Pillager"}}}] run summon minecraft:pillager ^ ^ ^ {HandItems:[{id:"minecraft:crossbow",Count:1b,tag:{AttributeModifiers:[{AttributeName:"generic.attack_damage",Name:"generic.attack_damage",Amount:1,Operation:0,UUID:[I;-55720091,611075810,-1271712052,-552013438]}]}},{}],Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Skeleton"}}}] run summon minecraft:skeleton ^ ^ ^ {HandItems:[{id:"minecraft:bow",Count:1b,tag:{AttributeModifiers:[{AttributeName:"generic.attack_damage",Name:"generic.attack_damage",Amount:1,Operation:0,UUID:[I;-55720091,611075810,-1271712052,-552013438]}]}},{}],Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Spider"}}}] run summon minecraft:spider ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Stray"}}}] run summon minecraft:stray ^ ^ ^ {HandItems:[{id:"minecraft:bow",Count:1b,tag:{AttributeModifiers:[{AttributeName:"generic.attack_damage",Name:"generic.attack_damage",Amount:1,Operation:0,UUID:[I;-55720091,611075810,-1271712052,-552013438]}]}},{}],Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Vindicator"}}}] run summon minecraft:vindicator ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Witch"}}}] run summon minecraft:witch ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Wither_Skeleton"}}}] run summon minecraft:wither_skeleton ^ ^ ^ {HandItems:[{id:"minecraft:bow",Count:1b,tag:{AttributeModifiers:[{AttributeName:"generic.attack_damage",Name:"generic.attack_damage",Amount:1,Operation:0,UUID:[I;-55720091,611075810,-1271712052,-552013438]}]}},{}],Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Zombie"}}}] run summon minecraft:zombie ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}
execute if entity @s[nbt={SelectedItem:{tag:{mob:"Zombified_Piglin"}}}] run summon minecraft:zombified_piglin ^ ^ ^ {Team:"deathsworn",Tags:["Deathsworn_Minion"],Attributes:[{Name:"generic.max_health",Base:100},{Name:"generic.follow_range",Base:32},{Name:"generic.knockback_resistance",Base:1},{Name:"generic.attack_damage",Base:1},{Name:"generic.armor",Base:1}]}

# this is how you prevent infinite attribute generation, the rest is on crystallize
execute store result score @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] Minion_Armor run data get entity @s SelectedItem.tag.Armor
execute store result score @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] Minion_Attack_Damage run data get entity @s SelectedItem.tag.AD
execute store result score @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] Minion_Health run data get entity @s SelectedItem.tag.Health

data modify entity @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] Attributes[{Name:"minecraft:generic.max_health"}].Base set from entity @s SelectedItem.tag.Health
data modify entity @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] Health set from entity @s SelectedItem.tag.Health
data modify entity @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] Attributes[{Name:"minecraft:generic.armor"}].Base set from entity @s SelectedItem.tag.Armor
data modify entity @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] Attributes[{Name:"minecraft:generic.attack_damage"}].Base set from entity @s SelectedItem.tag.AD
data modify entity @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] Size set from entity @s SelectedItem.tag.Size
data modify entity @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] IsImmuneToZombification set value 1
data modify entity @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] CanPickUpLoot set value 1b
data modify entity @e[tag=!Deathsworn_Dont_Touch,tag=Deathsworn_Minion,sort=nearest,limit=1] DeathLootTable set value "minecraft:empty"
#add an extra tag to make sure this minion doesnt get targeted next time a minion gets summoned
tag @s add Deathsworn_Dont_Touch
execute run power grant @e[tag=Deathsworn_Minion,distance=..1,sort=nearest,limit=1] origins-plus-plus:deathsworn/minions/kill


execute if entity @s[nbt={SelectedItem:{tag:{mob:"minecraft:spider"}}}] run advancement grant @s only origins-plus-plus:deathsworn/spider
execute if entity @s[nbt={SelectedItem:{tag:{mob:"minecraft:skeleton"}}}] run advancement grant @s only origins-plus-plus:deathsworn/skeleton
execute if entity @s[nbt={Dimension:"minecraft:overworld",SelectedItem:{tag:{mob:"minecraft:wither_skeleton"}}}] run advancement grant @s only origins-plus-plus:deathsworn/wither_skeleton
execute if entity @s[nbt={Dimension:"minecraft:overworld",SelectedItem:{tag:{mob:"minecraft:piglin_brute"}}}] run advancement grant @s only origins-plus-plus:deathsworn/brute
advancement grant @s only origins-plus-plus:deathsworn/summon

resource change @s origins-plus-plus:deathsworn/soul_bar -5
item modify entity @s weapon.mainhand origins-plus-plus:consume
